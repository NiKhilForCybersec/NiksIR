<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SPF/DKIM/DMARC | SOC Analyst Guide</title>
  <meta name="description" content="Email authentication protocols explained: SPF, DKIM, DMARC - how they work and how to interpret results.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Exo+2:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <button class="menu-toggle" aria-label="Toggle navigation">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M3 12h18M3 6h18M3 18h18"/>
    </svg>
  </button>

  <div class="page-wrapper">
        <aside class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo" style="text-decoration: none;">
          <span>SOC Analyst Guide</span>
        </a>
        <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.5rem;">v2.0 | 99 Pages</p>
      </div>
      
      <div class="sidebar-nav">
        <div class="search-box">
          <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
          </svg>
          <input type="text" class="search-input" placeholder="Search guide...">
        </div>

        <div class="nav-section">
          <div class="nav-section-title">1. SOC Foundations</div>
          <a href="getting-started.html" class="nav-link"><span class="nav-link-icon">ğŸš€</span> Getting Started</a>
          <a href="soc-overview.html" class="nav-link"><span class="nav-link-icon">ğŸ“‹</span> SOC Overview</a>
          <a href="soc-roles.html" class="nav-link"><span class="nav-link-icon">ğŸ‘¥</span> SOC Roles & Tiers</a>
          <a href="analyst-skills.html" class="nav-link"><span class="nav-link-icon">ğŸ¯</span> Analyst Skills</a>
          <a href="analyst-toolkit.html" class="nav-link"><span class="nav-link-icon">ğŸ§°</span> Analyst Toolkit</a>
          <a href="soc-metrics.html" class="nav-link"><span class="nav-link-icon">ğŸ“Š</span> SOC Metrics</a>
          <a href="shift-handoff.html" class="nav-link"><span class="nav-link-icon">ğŸ”„</span> Shift Handoff</a>
          <a href="alert-triage.html" class="nav-link"><span class="nav-link-icon">âš¡</span> Alert Triage</a>
          <a href="investigation-methodology.html" class="nav-link"><span class="nav-link-icon">ğŸ”</span> Investigation Methodology</a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">2. Ticketing & ITSM</div>
          <a href="ticket-management.html" class="nav-link"><span class="nav-link-icon">ğŸ«</span> Ticket Management</a>
          <a href="escalation-management.html" class="nav-link"><span class="nav-link-icon">ğŸ“ˆ</span> Escalation</a>
          <a href="communication-practices.html" class="nav-link"><span class="nav-link-icon">ğŸ’¬</span> Communication</a>
          <a href="status-reporting.html" class="nav-link"><span class="nav-link-icon">ğŸ“Š</span> Status Reporting</a>
          <a href="handoff-procedures.html" class="nav-link"><span class="nav-link-icon">ğŸ”„</span> Handoff Procedures</a>
          <a href="sla-management.html" class="nav-link"><span class="nav-link-icon">â±ï¸</span> SLA Management</a>
        </div>

                <div class="nav-section">
          <div class="nav-section-title">3. SIEM & Log Analysis</div>
          <a href="siem-fundamentals.html" class="nav-link"><span class="nav-link-icon">ğŸ“¡</span> SIEM Fundamentals</a>
          <a href="sentinel-overview.html" class="nav-link"><span class="nav-link-icon">ğŸ›¡ï¸</span> Microsoft Sentinel</a>
          <a href="sentinel-queries.html" class="nav-link"><span class="nav-link-icon">ğŸ’»</span> Sentinel Queries</a>
          <a href="kql-advanced.html" class="nav-link"><span class="nav-link-icon">ğŸš€</span> KQL Advanced</a>
          <a href="kql-cheatsheet.html" class="nav-link"><span class="nav-link-icon">ğŸ“‹</span> KQL Cheatsheet</a>
          <a href="splunk-overview.html" class="nav-link"><span class="nav-link-icon">ğŸŸ¢</span> Splunk Overview</a>
          <a href="splunk-queries.html" class="nav-link"><span class="nav-link-icon">ğŸ’»</span> Splunk Queries</a>
          <a href="spl-advanced.html" class="nav-link"><span class="nav-link-icon">ğŸš€</span> SPL Advanced</a>
          <a href="spl-cheatsheet.html" class="nav-link"><span class="nav-link-icon">ğŸ“‹</span> SPL Cheatsheet</a>
          <a href="splunk-dashboards.html" class="nav-link"><span class="nav-link-icon">ğŸ“Š</span> Splunk Dashboards</a>
          <a href="splunk-alerts.html" class="nav-link"><span class="nav-link-icon">ğŸ””</span> Splunk Alerts</a>
          <a href="alert-creation.html" class="nav-link"><span class="nav-link-icon">ğŸ””</span> Alert Creation</a>
          <a href="siem-tuning.html" class="nav-link"><span class="nav-link-icon">ğŸšï¸</span> SIEM Tuning</a>
          <a href="workbook-creation.html" class="nav-link"><span class="nav-link-icon">ğŸ“ˆ</span> Workbook Creation</a>
          <a href="log-sources.html" class="nav-link"><span class="nav-link-icon">ğŸ“‹</span> Log Sources</a>
          <a href="log-correlation.html" class="nav-link"><span class="nav-link-icon">ğŸ”—</span> Log Correlation</a>
          <a href="threat-hunting.html" class="nav-link"><span class="nav-link-icon">ğŸ¯</span> Threat Hunting</a>
          <a href="hunting-queries.html" class="nav-link"><span class="nav-link-icon">ğŸ”</span> Hunting Queries</a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">4. EDR/XDR</div>
          <a href="edr-fundamentals.html" class="nav-link"><span class="nav-link-icon">ğŸ”’</span> EDR Fundamentals</a>
          <a href="edr-deep-dive.html" class="nav-link"><span class="nav-link-icon">ğŸ”¬</span> EDR Deep Dive</a>
          <a href="edr-investigation.html" class="nav-link"><span class="nav-link-icon">ğŸ•µï¸</span> EDR Investigation</a>
          <a href="edr-hunting.html" class="nav-link"><span class="nav-link-icon">ğŸ¯</span> EDR Hunting</a>
          <a href="isolation-procedures.html" class="nav-link"><span class="nav-link-icon">ğŸ”’</span> Isolation Procedures</a>
          <a href="xdr-overview.html" class="nav-link"><span class="nav-link-icon">ğŸŒ</span> XDR Overview</a>
          <a href="mde-overview.html" class="nav-link"><span class="nav-link-icon">ğŸ›¡ï¸</span> MDE Overview</a>
          <a href="mde-queries.html" class="nav-link"><span class="nav-link-icon">ğŸ’»</span> MDE Queries</a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">5. Network Security</div>
          <a href="network-fundamentals.html" class="nav-link"><span class="nav-link-icon">ğŸŒ</span> Network Fundamentals</a>
          <a href="firewall-basics.html" class="nav-link"><span class="nav-link-icon">ğŸ”¥</span> Firewall Basics</a>
          <a href="ids-ips.html" class="nav-link"><span class="nav-link-icon">ğŸš¨</span> IDS/IPS</a>
          <a href="proxy-analysis.html" class="nav-link"><span class="nav-link-icon">ğŸ”€</span> Proxy Analysis</a>
          <a href="dns-security.html" class="nav-link"><span class="nav-link-icon">ğŸŒ</span> DNS Security</a>
          <a href="traffic-analysis.html" class="nav-link"><span class="nav-link-icon">ğŸ“Š</span> Traffic Analysis</a>
          <a href="network-forensics.html" class="nav-link"><span class="nav-link-icon">ğŸ”</span> Network Forensics</a>
          <a href="vpn-security.html" class="nav-link"><span class="nav-link-icon">ğŸ”</span> VPN Security</a>
          <a href="network-segmentation.html" class="nav-link"><span class="nav-link-icon">ğŸ”€</span> Segmentation</a>
          <a href="zero-trust.html" class="nav-link"><span class="nav-link-icon">ğŸ”</span> Zero Trust</a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">6. Cloud Security</div>
          <a href="cloud-overview.html" class="nav-link"><span class="nav-link-icon">â˜ï¸</span> Cloud Overview</a>
          <a href="aws-security.html" class="nav-link"><span class="nav-link-icon">ğŸ”¶</span> AWS Security</a>
          <a href="azure-security.html" class="nav-link"><span class="nav-link-icon">ğŸ”·</span> Azure Security</a>
          <a href="gcp-security.html" class="nav-link"><span class="nav-link-icon">ğŸ”´</span> GCP Security</a>
          <a href="m365-security.html" class="nav-link"><span class="nav-link-icon">ğŸ“§</span> M365 Security</a>
          <a href="cloud-iam.html" class="nav-link"><span class="nav-link-icon">ğŸ”‘</span> Cloud IAM</a>
          <a href="container-security.html" class="nav-link"><span class="nav-link-icon">ğŸ“¦</span> Container Security</a>
          <a href="serverless-security.html" class="nav-link"><span class="nav-link-icon">âš¡</span> Serverless Security</a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">7. Email & Phishing</div>
          <a href="email-security.html" class="nav-link"><span class="nav-link-icon">ğŸ“§</span> Email Security</a>
          <a href="phishing-analysis.html" class="nav-link"><span class="nav-link-icon">ğŸ£</span> Phishing Analysis</a>
          <a href="email-headers.html" class="nav-link"><span class="nav-link-icon">ğŸ“‹</span> Email Headers</a>
          <a href="email-auth.html" class="nav-link active"><span class="nav-link-icon">ğŸ”</span> Email Authentication</a>
          <a href="bec-attacks.html" class="nav-link"><span class="nav-link-icon">ğŸ’¼</span> BEC Attacks</a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">8. Identity & Access</div>
          <a href="identity-overview.html" class="nav-link"><span class="nav-link-icon">ğŸ‘¤</span> Identity Overview</a>
          <a href="azure-ad-security.html" class="nav-link"><span class="nav-link-icon">ğŸ”·</span> Azure AD Security</a>
          <a href="ad-security.html" class="nav-link"><span class="nav-link-icon">ğŸ¢</span> AD Security</a>
          <a href="privileged-access.html" class="nav-link"><span class="nav-link-icon">ğŸ‘‘</span> Privileged Access</a>
          <a href="mfa-deep-dive.html" class="nav-link"><span class="nav-link-icon">ğŸ”</span> MFA Deep Dive</a>
          <a href="service-accounts.html" class="nav-link"><span class="nav-link-icon">âš™ï¸</span> Service Accounts</a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">9. Data Protection</div>
          <a href="data-classification.html" class="nav-link"><span class="nav-link-icon">ğŸ“Š</span> Data Classification</a>
          <a href="dlp-overview.html" class="nav-link"><span class="nav-link-icon">ğŸ›¡ï¸</span> DLP Overview</a>
          <a href="dlp-investigation.html" class="nav-link"><span class="nav-link-icon">ğŸ”</span> DLP Investigation</a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">10. Incident Response</div>
          <a href="ir-overview.html" class="nav-link"><span class="nav-link-icon">ğŸš¨</span> IR Overview</a>
          <a href="ir-classification.html" class="nav-link"><span class="nav-link-icon">ğŸ“‹</span> Classification</a>
          <a href="ir-containment.html" class="nav-link"><span class="nav-link-icon">ğŸ”’</span> Containment</a>
          <a href="ir-eradication.html" class="nav-link"><span class="nav-link-icon">ğŸ§¹</span> Eradication</a>
          <a href="ir-recovery.html" class="nav-link"><span class="nav-link-icon">ğŸ”„</span> Recovery</a>
          <a href="ir-communication.html" class="nav-link"><span class="nav-link-icon">ğŸ’¬</span> Communication</a>
          <a href="evidence-handling.html" class="nav-link"><span class="nav-link-icon">ğŸ“¦</span> Evidence Handling</a>
          <a href="lessons-learned.html" class="nav-link"><span class="nav-link-icon">ğŸ“</span> Lessons Learned</a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">11. Playbooks</div>
          <a href="pb-phishing.html" class="nav-link"><span class="nav-link-icon">ğŸ£</span> Phishing</a>
          <a href="pb-malware.html" class="nav-link"><span class="nav-link-icon">ğŸ¦ </span> Malware</a>
          <a href="pb-ransomware.html" class="nav-link"><span class="nav-link-icon">ğŸ’°</span> Ransomware</a>
          <a href="pb-account-compromise.html" class="nav-link"><span class="nav-link-icon">ğŸ‘¤</span> Account Compromise</a>
          <a href="pb-brute-force.html" class="nav-link"><span class="nav-link-icon">ğŸ”“</span> Brute Force</a>
          <a href="pb-impossible-travel.html" class="nav-link"><span class="nav-link-icon">âœˆï¸</span> Impossible Travel</a>
          <a href="pb-data-exfiltration.html" class="nav-link"><span class="nav-link-icon">ğŸ“¤</span> Data Exfiltration</a>
          <a href="pb-insider-threat.html" class="nav-link"><span class="nav-link-icon">ğŸ•µï¸</span> Insider Threat</a>
          <a href="pb-lateral-movement.html" class="nav-link"><span class="nav-link-icon">â†”ï¸</span> Lateral Movement</a>
          <a href="pb-c2.html" class="nav-link"><span class="nav-link-icon">ğŸ“¡</span> C2 Detection</a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">12. Reference</div>
          <a href="quick-reference.html" class="nav-link"><span class="nav-link-icon">âš¡</span> Quick Reference</a>
          <a href="common-ports.html" class="nav-link"><span class="nav-link-icon">ğŸ”Œ</span> Common Ports</a>
          <a href="windows-events.html" class="nav-link"><span class="nav-link-icon">ğŸªŸ</span> Windows Events</a>
          <a href="kql-cheatsheet.html" class="nav-link"><span class="nav-link-icon">ğŸ“‹</span> KQL Cheatsheet</a>
          <a href="regex-patterns.html" class="nav-link"><span class="nav-link-icon">ğŸ”£</span> Regex Patterns</a>
          <a href="mitre-reference.html" class="nav-link"><span class="nav-link-icon">ğŸ—ºï¸</span> MITRE Reference</a>
          <a href="ioc-tools.html" class="nav-link"><span class="nav-link-icon">ğŸ”§</span> IOC Tools</a>
          <a href="documentation.html" class="nav-link"><span class="nav-link-icon">ğŸ“</span> Documentation</a>
        </div>
      </div>
    </aside>

    <!-- Sidebar Toggle -->
    <button class="sidebar-toggle" aria-label="Toggle sidebar">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M15 18l-6-6 6-6"/>
      </svg>
    </button>

    <main class="main-content">
      <div class="content-header">
        <nav class="breadcrumb">
          <a href="index.html">Home</a>
          <span class="breadcrumb-separator">â€º</span>
          <a href="index.html#email">Email & Phishing</a>
          <span class="breadcrumb-separator">â€º</span>
          <span>SPF/DKIM/DMARC</span>
        </nav>
        <h1>SPF/DKIM/DMARC</h1>
        <div class="page-meta">
          <span class="meta-item"><span class="tier-badge tier-l1">L1</span> <span class="tier-badge tier-l2">L2</span></span>
          <span class="meta-item">Section 7.3</span>
          <span class="meta-item">~12 min read</span>
        </div>
      </div>

      <div class="toc">
        <div class="toc-title">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 6h16M4 12h16M4 18h12"/>
          </svg>
          On This Page
        </div>
        <ul class="toc-list">
          <li><a href="#overview">Overview</a></li>
          <li><a href="#spf">SPF</a></li>
          <li><a href="#dkim">DKIM</a></li>
          <li><a href="#dmarc">DMARC</a></li>
          <li><a href="#together">How They Work Together</a></li>
          <li><a href="#investigation">Investigation Guide</a></li>
        </ul>
      </div>

      <section id="overview">
        <h2>Email Authentication Overview</h2>
        <p>
          SPF, DKIM, and DMARC work together to verify that emails actually come from who they 
          claim to be from. Understanding these is crucial for investigating phishing.
        </p>

        <div class="card-grid">
          <div class="card">
            <h4 style="color: var(--accent-cyan);">SPF</h4>
            <p><strong>Sender Policy Framework</strong></p>
            <p>Verifies the sending server is authorized to send for the domain.</p>
          </div>
          <div class="card">
            <h4 style="color: var(--accent-green);">DKIM</h4>
            <p><strong>DomainKeys Identified Mail</strong></p>
            <p>Cryptographically signs emails to prove authenticity.</p>
          </div>
          <div class="card">
            <h4 style="color: var(--accent-orange);">DMARC</h4>
            <p><strong>Domain-based Message Authentication</strong></p>
            <p>Tells receivers what to do when SPF/DKIM fail.</p>
          </div>
        </div>
      </section>

      <section id="spf">
        <h2>SPF - Sender Policy Framework</h2>

        <h3>What SPF Does</h3>
        <p>
          SPF allows domain owners to specify which mail servers are authorized to send email 
          on behalf of their domain. It's a DNS TXT record that lists approved senders.
        </p>

        <div class="card">
          <h3>How SPF Works</h3>
          <div class="flowchart">
            <div class="flow-step">
              <div class="flow-node">
                <strong>Email Received</strong><br>
                <small>From: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d0a5a3b5a290b5a8b1bda0bcb5feb3bfbd">[email&#160;protected]</a></small>
              </div>
              <div class="flow-arrow">â†’</div>
              <div class="flow-node">
                <strong>Check DNS</strong><br>
                <small>Query example.com SPF</small>
              </div>
              <div class="flow-arrow">â†’</div>
              <div class="flow-node">
                <strong>Compare IP</strong><br>
                <small>Is sender IP in list?</small>
              </div>
              <div class="flow-arrow">â†’</div>
              <div class="flow-node">
                <strong>Result</strong><br>
                <small>Pass/Fail/SoftFail</small>
              </div>
            </div>
          </div>
        </div>

        <h3>Example SPF Record</h3>
        <div class="terminal">
          <div class="terminal-header">
            <span class="terminal-dot red"></span>
            <span class="terminal-dot yellow"></span>
            <span class="terminal-dot green"></span>
            <span style="margin-left: 1rem; color: var(--text-muted);">DNS TXT Record</span>
          </div>
          <div class="terminal-body">
<pre>v=spf1 include:_spf.google.com include:spf.protection.outlook.com ip4:203.0.113.0/24 -all

<span style="color: var(--text-muted);">v=spf1         = SPF version 1
include:...    = Include another domain's SPF
ip4:...        = Authorize this IP range
-all           = Reject all others (hard fail)</span></pre>
          </div>
        </div>

        <h3>SPF Results</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Result</th>
                <th>Meaning</th>
                <th>Typical Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span style="color: var(--accent-green);">Pass</span></td>
                <td>IP is authorized to send</td>
                <td>Accept normally</td>
              </tr>
              <tr>
                <td><span style="color: var(--accent-red);">Fail (-all)</span></td>
                <td>IP is NOT authorized</td>
                <td>Reject or quarantine</td>
              </tr>
              <tr>
                <td><span style="color: var(--accent-yellow);">SoftFail (~all)</span></td>
                <td>IP is probably not authorized</td>
                <td>Accept but mark suspicious</td>
              </tr>
              <tr>
                <td><span style="color: var(--text-muted);">Neutral (?all)</span></td>
                <td>No assertion made</td>
                <td>Accept normally</td>
              </tr>
              <tr>
                <td><span style="color: var(--text-muted);">None</span></td>
                <td>No SPF record published</td>
                <td>No SPF protection</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section id="dkim">
        <h2>DKIM - DomainKeys Identified Mail</h2>

        <h3>What DKIM Does</h3>
        <p>
          DKIM adds a digital signature to emails that proves the message hasn't been modified 
          and actually originated from the claimed domain.
        </p>

        <div class="card">
          <h3>How DKIM Works</h3>
          <ol>
            <li>Sending server creates hash of message headers/body</li>
            <li>Hash is encrypted with private key â†’ signature</li>
            <li>Signature added to email header (DKIM-Signature)</li>
            <li>Receiving server fetches public key from DNS</li>
            <li>Decrypts signature, compares with calculated hash</li>
            <li>Match = Pass; Mismatch = Fail</li>
          </ol>
        </div>

        <h3>DKIM-Signature Header</h3>
        <div class="terminal">
          <div class="terminal-header">
            <span class="terminal-dot red"></span>
            <span class="terminal-dot yellow"></span>
            <span class="terminal-dot green"></span>
            <span style="margin-left: 1rem; color: var(--text-muted);">DKIM Header</span>
          </div>
          <div class="terminal-body">
<pre>DKIM-Signature: v=1; a=rsa-sha256; d=example.com; s=selector1;
    h=from:to:subject:date; bh=abc123...; b=xyz789...

<span style="color: var(--text-muted);">d=example.com  = Signing domain
s=selector1    = Selector (finds public key)
h=from:to:...  = Headers that were signed
bh=...         = Body hash
b=...          = Signature</span></pre>
          </div>
        </div>

        <div class="callout callout-info">
          <div class="callout-title">DKIM Protects Against</div>
          <ul style="margin: 0;">
            <li>Message modification in transit</li>
            <li>Some forms of domain spoofing</li>
            <li>Forged headers (if signed)</li>
          </ul>
        </div>
      </section>

      <section id="dmarc">
        <h2>DMARC - Domain-based Message Authentication</h2>

        <h3>What DMARC Does</h3>
        <p>
          DMARC builds on SPF and DKIM by telling receiving servers what to do when 
          authentication fails, and provides reporting back to domain owners.
        </p>

        <h3>DMARC Policy Options</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Policy (p=)</th>
                <th>Action</th>
                <th>Use Case</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>none</strong></td>
                <td>Monitor only, take no action</td>
                <td>Initial deployment, testing</td>
              </tr>
              <tr>
                <td><strong>quarantine</strong></td>
                <td>Send to spam/junk folder</td>
                <td>Intermediate enforcement</td>
              </tr>
              <tr>
                <td><strong>reject</strong></td>
                <td>Block the email entirely</td>
                <td>Full protection</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>Example DMARC Record</h3>
        <div class="terminal">
          <div class="terminal-header">
            <span class="terminal-dot red"></span>
            <span class="terminal-dot yellow"></span>
            <span class="terminal-dot green"></span>
            <span style="margin-left: 1rem; color: var(--text-muted);">_dmarc.example.com TXT</span>
          </div>
          <div class="terminal-body">
<pre>v=DMARC1; p=reject; rua=mailto:<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="cfaba2aebdac8faab7aea2bfa3aae1aca0a2">[email&#160;protected]</a>; pct=100

<span style="color: var(--text-muted);">v=DMARC1    = DMARC version
p=reject    = Policy: reject failed emails
rua=...     = Send aggregate reports here
pct=100     = Apply to 100% of emails</span></pre>
          </div>
        </div>

        <h3>DMARC Alignment</h3>
        <p>
          For DMARC to pass, either SPF or DKIM must pass <strong>and</strong> be aligned 
          (domain matches the "From" header).
        </p>
        <div class="card" style="border-left: 4px solid var(--accent-cyan);">
          <h4>DMARC Pass Requirements</h4>
          <p><strong>Option 1:</strong> SPF passes AND SPF domain aligns with From domain</p>
          <p><strong>Option 2:</strong> DKIM passes AND DKIM domain aligns with From domain</p>
          <p><em>Only ONE of these needs to be true for DMARC to pass.</em></p>
        </div>
      </section>

      <section id="together">
        <h2>How They Work Together</h2>

        <div class="card">
          <h3>Authentication Flow</h3>
          <div class="flowchart">
            <div class="flow-step">
              <div class="flow-node">
                <strong>1. SPF Check</strong><br>
                <small>Is sender IP authorized?</small>
              </div>
              <div class="flow-arrow">â†’</div>
              <div class="flow-node">
                <strong>2. DKIM Check</strong><br>
                <small>Is signature valid?</small>
              </div>
              <div class="flow-arrow">â†’</div>
              <div class="flow-node">
                <strong>3. DMARC Check</strong><br>
                <small>Alignment + Policy</small>
              </div>
              <div class="flow-arrow">â†’</div>
              <div class="flow-node">
                <strong>4. Action</strong><br>
                <small>Accept/Quarantine/Reject</small>
              </div>
            </div>
          </div>
        </div>

        <h3>Result Combinations</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>SPF</th>
                <th>DKIM</th>
                <th>DMARC</th>
                <th>Interpretation</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>âœ… Pass</td>
                <td>âœ… Pass</td>
                <td>âœ… Pass</td>
                <td>Legitimate email, fully authenticated</td>
              </tr>
              <tr>
                <td>âœ… Pass</td>
                <td>âŒ Fail</td>
                <td>âœ… Pass</td>
                <td>Legitimate (DKIM may fail in forwarding)</td>
              </tr>
              <tr>
                <td>âŒ Fail</td>
                <td>âœ… Pass</td>
                <td>âœ… Pass</td>
                <td>Legitimate (common with email services)</td>
              </tr>
              <tr>
                <td>âŒ Fail</td>
                <td>âŒ Fail</td>
                <td>âŒ Fail</td>
                <td>Likely spoofed - investigate</td>
              </tr>
              <tr>
                <td>âœ… Pass</td>
                <td>âœ… Pass</td>
                <td>âŒ Fail</td>
                <td>Alignment issue - check From domain</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section id="investigation">
        <h2>Investigation Guide</h2>

        <h3>Quick Check Process</h3>
        <ul class="checklist">
          <li>Look for Authentication-Results header</li>
          <li>Check SPF result - pass/fail?</li>
          <li>Check DKIM result - pass/fail?</li>
          <li>Check DMARC result - pass/fail?</li>
          <li>If any fail, compare From domain with Return-Path/DKIM domain</li>
          <li>Check domain reputation and registration date</li>
        </ul>

        <h3>Lookup Commands</h3>
        <div class="query-box">
          <div class="query-header">
            <span class="query-lang">Bash</span>
            <span class="query-title">Check SPF record</span>
          </div>
          <div class="query-body">
<code>nslookup -type=txt example.com
<span class="cm"># or</span>
dig txt example.com</code>
          </div>
        </div>

        <div class="query-box">
          <div class="query-header">
            <span class="query-lang">Bash</span>
            <span class="query-title">Check DMARC record</span>
          </div>
          <div class="query-body">
<code>nslookup -type=txt _dmarc.example.com
<span class="cm"># or</span>
dig txt _dmarc.example.com</code>
          </div>
        </div>

        <div class="callout callout-warning">
          <div class="callout-title">Common False Positive: Email Forwarding</div>
          <p style="margin: 0;">
            Forwarded emails often fail SPF because the forwarding server's IP isn't in the 
            original sender's SPF record. DKIM usually survives forwarding if the message isn't 
            modified. Check if the email was forwarded before concluding it's spoofed.
          </p>
        </div>
      </section>

      <div class="callout callout-success">
        <div class="callout-title">Key Takeaways</div>
        <ul style="margin: 0;">
          <li><strong>SPF:</strong> Verifies sending server is authorized (IP-based)</li>
          <li><strong>DKIM:</strong> Cryptographic signature proves authenticity</li>
          <li><strong>DMARC:</strong> Policy enforcement + alignment requirement</li>
          <li>All three should pass for fully authenticated email</li>
          <li>SPF/DKIM can fail legitimately (forwarding, mailing lists)</li>
          <li>DMARC fail with p=reject is strong spoofing indicator</li>
          <li>Always check the actual domains, not just pass/fail</li>
        </ul>
      </div>

      <footer class="page-footer">
        <div class="footer-nav">
          <a href="email-headers.html" class="footer-link">
            <span class="footer-link-label">â† Previous</span>
            <span class="footer-link-title">Header Analysis</span>
          </a>
      </footer>
    </main>
  </div>
  <script src="main.js"></script>
</body>
</html>