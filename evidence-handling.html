<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Evidence Handling | SOC Analyst Guide by NIK</title>
  <meta name="description" content="Digital evidence handling: chain of custody, forensic acquisition, evidence preservation, and documentation requirements.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600&family=Orbitron:wght@400;500;600;700&family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <button class="menu-toggle" aria-label="Toggle navigation">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M3 12h18M3 6h18M3 18h18"/>
    </svg>
  </button>

  <div class="page-wrapper">
    <aside class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo" style="text-decoration: none;">
          <span>SOC Analyst Guide by NIK</span>
        </a>
      </div>
      <div class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">10. Incident Response</div>
          <a href="ir-overview.html" class="nav-link"><span class="nav-link-icon">üö®</span> IR Overview</a>
          <a href="ir-classification.html" class="nav-link"><span class="nav-link-icon">üìä</span> Classification</a>
          <a href="ir-containment.html" class="nav-link"><span class="nav-link-icon">üîí</span> Containment</a>
          <a href="ir-eradication.html" class="nav-link"><span class="nav-link-icon">üßπ</span> Eradication</a>
          <a href="ir-recovery.html" class="nav-link"><span class="nav-link-icon">üîÑ</span> Recovery</a>
          <a href="evidence-handling.html" class="nav-link active"><span class="nav-link-icon">üì¶</span> Evidence Handling</a>
          <a href="lessons-learned.html" class="nav-link"><span class="nav-link-icon">üìù</span> Lessons Learned</a>
        </div>
      </div>
    </aside>

    <main class="main-content">
      <div class="content-header">
        <nav class="breadcrumb">
          <a href="index.html">Home</a>
          <span class="breadcrumb-separator">‚Ä∫</span>
          <a href="index.html#ir">Incident Response</a>
          <span class="breadcrumb-separator">‚Ä∫</span>
          <span>Evidence Handling</span>
        </nav>
        <h1>Evidence Handling</h1>
        <div class="page-meta">
          <span class="meta-item"><span class="tier-badge tier-l2">L2</span> <span class="tier-badge tier-l3">L3</span></span>
          <span class="meta-item">Section 10.7</span>
          <span class="meta-item">~22 min read</span>
        </div>
      </div>

      <div class="toc">
        <div class="toc-title">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 6h16M4 12h16M4 18h12"/>
          </svg>
          On This Page
        </div>
        <ul class="toc-list">
          <li><a href="#principles">Evidence Principles</a></li>
          <li><a href="#chain">Chain of Custody</a></li>
          <li><a href="#collection">Evidence Collection</a></li>
          <li><a href="#acquisition">Forensic Acquisition</a></li>
          <li><a href="#preservation">Preservation</a></li>
          <li><a href="#documentation">Documentation</a></li>
        </ul>
      </div>

      <section id="principles">
        <h2>Evidence Principles</h2>
        <p>
          Proper evidence handling ensures findings are admissible in legal proceedings 
          and defensible during incident reviews. Poor handling can invalidate critical evidence.
        </p>

        <div class="card-grid">
          <div class="card">
            <h4>Why Evidence Handling Matters</h4>
            <ul>
              <li>Legal proceedings may require evidence</li>
              <li>HR actions need documented proof</li>
              <li>Insurance claims require evidence</li>
              <li>Regulatory compliance requirements</li>
              <li>Internal accountability</li>
            </ul>
          </div>
          <div class="card">
            <h4>Key Principles</h4>
            <ul>
              <li><strong>Integrity:</strong> Evidence is unaltered</li>
              <li><strong>Authenticity:</strong> Evidence is genuine</li>
              <li><strong>Completeness:</strong> All relevant evidence collected</li>
              <li><strong>Chain of Custody:</strong> Documented handling</li>
              <li><strong>Reproducibility:</strong> Others can verify</li>
            </ul>
          </div>
        </div>

        <div class="callout callout-warning">
          <div class="callout-title">When to Involve Legal/HR</div>
          <p style="margin: 0;">
            Before collecting evidence in cases involving: employee misconduct, potential 
            criminal activity, regulatory violations, or litigation hold. Improper collection 
            can compromise investigations or violate privacy laws.
          </p>
        </div>

        <h3>Order of Volatility</h3>
        <p>
          Collect evidence in order of volatility‚Äîmost volatile first, as it disappears quickly.
        </p>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Priority</th>
                <th>Evidence Type</th>
                <th>Volatility</th>
                <th>Collection Window</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>CPU registers, cache</td>
                <td><span style="color: var(--accent-red);">Highest</span></td>
                <td>Nanoseconds</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Memory (RAM)</td>
                <td><span style="color: var(--accent-red);">Very High</span></td>
                <td>Lost on reboot</td>
              </tr>
              <tr>
                <td>3</td>
                <td>Network connections, process state</td>
                <td><span style="color: var(--accent-orange);">High</span></td>
                <td>Seconds to minutes</td>
              </tr>
              <tr>
                <td>4</td>
                <td>Running processes, open files</td>
                <td><span style="color: var(--accent-orange);">High</span></td>
                <td>Minutes</td>
              </tr>
              <tr>
                <td>5</td>
                <td>Disk (filesystem)</td>
                <td><span style="color: var(--accent-yellow);">Medium</span></td>
                <td>Persistent until overwritten</td>
              </tr>
              <tr>
                <td>6</td>
                <td>Remote logs, backups</td>
                <td><span style="color: var(--accent-green);">Low</span></td>
                <td>Days to months (retention policy)</td>
              </tr>
              <tr>
                <td>7</td>
                <td>Archival media</td>
                <td><span style="color: var(--accent-green);">Lowest</span></td>
                <td>Years</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section id="chain">
        <h2>Chain of Custody</h2>
        <p>
          Chain of custody documents every person who handled evidence, when, and what 
          they did. Broken chain of custody can make evidence inadmissible.
        </p>

        <h3>Chain of Custody Form Elements</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Case/Incident ID</strong></td>
                <td>Unique identifier linking to incident ticket</td>
              </tr>
              <tr>
                <td><strong>Evidence ID</strong></td>
                <td>Unique identifier for this piece of evidence</td>
              </tr>
              <tr>
                <td><strong>Description</strong></td>
                <td>Detailed description of evidence item</td>
              </tr>
              <tr>
                <td><strong>Collection Date/Time</strong></td>
                <td>When evidence was collected (with timezone)</td>
              </tr>
              <tr>
                <td><strong>Collected By</strong></td>
                <td>Name of person who collected evidence</td>
              </tr>
              <tr>
                <td><strong>Collection Location</strong></td>
                <td>Where evidence was collected from</td>
              </tr>
              <tr>
                <td><strong>Hash Values</strong></td>
                <td>MD5, SHA1, SHA256 of digital evidence</td>
              </tr>
              <tr>
                <td><strong>Storage Location</strong></td>
                <td>Where evidence is stored</td>
              </tr>
              <tr>
                <td><strong>Transfer Log</strong></td>
                <td>Each transfer: from, to, date, time, purpose</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>Chain of Custody Best Practices</h3>
        <ul class="checklist">
          <li>Create chain of custody document immediately upon collection</li>
          <li>Minimize number of people handling evidence</li>
          <li>Document every transfer with signatures</li>
          <li>Store evidence in locked, access-controlled location</li>
          <li>Log all access to evidence storage</li>
          <li>Use tamper-evident bags/seals for physical evidence</li>
          <li>Verify hashes before and after any analysis</li>
        </ul>
      </section>

      <section id="collection">
        <h2>Evidence Collection</h2>

        <h3>Types of Digital Evidence</h3>
        <div class="accordion">
          <div class="accordion-item active">
            <div class="accordion-header">
              <span class="accordion-title">Endpoint Evidence</span>
              <span class="accordion-icon">‚ñº</span>
            </div>
            <div class="accordion-content">
              <ul>
                <li><strong>Memory dump:</strong> Running processes, encryption keys, malware in memory</li>
                <li><strong>Disk image:</strong> Files, deleted files, slack space</li>
                <li><strong>Event logs:</strong> Windows Security, System, Application logs</li>
                <li><strong>Registry:</strong> Configuration, persistence mechanisms, user activity</li>
                <li><strong>Browser artifacts:</strong> History, downloads, cookies, cache</li>
                <li><strong>Prefetch/Amcache:</strong> Program execution history</li>
                <li><strong>$MFT:</strong> Master File Table with file metadata</li>
              </ul>
            </div>
          </div>

          <div class="accordion-item">
            <div class="accordion-header">
              <span class="accordion-title">Network Evidence</span>
              <span class="accordion-icon">‚ñº</span>
            </div>
            <div class="accordion-content">
              <ul>
                <li><strong>Packet captures:</strong> Full content of network traffic</li>
                <li><strong>Flow data:</strong> NetFlow/IPFIX metadata</li>
                <li><strong>Firewall logs:</strong> Allowed/blocked connections</li>
                <li><strong>Proxy logs:</strong> Web traffic with URLs</li>
                <li><strong>DNS logs:</strong> Name resolution queries</li>
                <li><strong>IDS/IPS alerts:</strong> Detected threats</li>
              </ul>
            </div>
          </div>

          <div class="accordion-item">
            <div class="accordion-header">
              <span class="accordion-title">Cloud/SaaS Evidence</span>
              <span class="accordion-icon">‚ñº</span>
            </div>
            <div class="accordion-content">
              <ul>
                <li><strong>Authentication logs:</strong> Sign-ins, MFA events</li>
                <li><strong>Audit logs:</strong> Administrative actions</li>
                <li><strong>Activity logs:</strong> User file/email access</li>
                <li><strong>Cloud trail/activity:</strong> AWS CloudTrail, Azure Activity Log</li>
                <li><strong>Configuration snapshots:</strong> Point-in-time settings</li>
              </ul>
            </div>
          </div>

          <div class="accordion-item">
            <div class="accordion-header">
              <span class="accordion-title">Application Evidence</span>
              <span class="accordion-icon">‚ñº</span>
            </div>
            <div class="accordion-content">
              <ul>
                <li><strong>Application logs:</strong> Database, web server, custom apps</li>
                <li><strong>Email:</strong> Messages, headers, attachments</li>
                <li><strong>Database records:</strong> Transaction logs, audit tables</li>
                <li><strong>Backups:</strong> Historical state comparison</li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <section id="acquisition">
        <h2>Forensic Acquisition</h2>

        <h3>Memory Acquisition</h3>
        <div class="terminal">
          <div class="terminal-header">
            <span class="terminal-dot red"></span>
            <span class="terminal-dot yellow"></span>
            <span class="terminal-dot green"></span>
            <span style="margin-left: 1rem; color: var(--text-muted);">Memory Acquisition Tools</span>
          </div>
          <div class="terminal-body">
<pre><span style="color: var(--accent-cyan);"># Windows - WinPMEM</span>
winpmem_mini_x64.exe output.raw

<span style="color: var(--accent-cyan);"># Windows - DumpIt (single click)</span>
DumpIt.exe

<span style="color: var(--accent-cyan);"># Linux - LiME</span>
insmod lime.ko "path=/evidence/memory.lime format=lime"

<span style="color: var(--accent-cyan);"># macOS - osxpmem</span>
sudo osxpmem -o memory.aff4

<span style="color: var(--accent-cyan);"># Verify hash after acquisition</span>
sha256sum output.raw > output.raw.sha256</pre>
          </div>
        </div>

        <h3>Disk Imaging</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Tool</th>
                <th>Platform</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>FTK Imager</strong></td>
                <td>Windows</td>
                <td>Free, creates E01 images, verifies hashes</td>
              </tr>
              <tr>
                <td><strong>dd</strong></td>
                <td>Linux/macOS</td>
                <td>Built-in, raw images, use dcfldd for hashing</td>
              </tr>
              <tr>
                <td><strong>Guymager</strong></td>
                <td>Linux</td>
                <td>GUI, fast, supports E01/AFF</td>
              </tr>
              <tr>
                <td><strong>KAPE</strong></td>
                <td>Windows</td>
                <td>Targeted collection, fast triage</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="terminal">
          <div class="terminal-header">
            <span class="terminal-dot red"></span>
            <span class="terminal-dot yellow"></span>
            <span class="terminal-dot green"></span>
            <span style="margin-left: 1rem; color: var(--text-muted);">Disk Imaging Commands</span>
          </div>
          <div class="terminal-body">
<pre><span style="color: var(--accent-cyan);"># Linux dd with hashing</span>
dc3dd if=/dev/sda of=/evidence/disk.dd hash=sha256 log=/evidence/disk.log

<span style="color: var(--accent-cyan);"># dcfldd (enhanced dd)</span>
dcfldd if=/dev/sda of=/evidence/disk.dd hash=sha256 hashlog=/evidence/hash.txt

<span style="color: var(--accent-cyan);"># Create write-blocker mount (read-only)</span>
mount -o ro,noexec,noatime /dev/sdb1 /mnt/evidence

<span style="color: var(--accent-cyan);"># Verify image integrity</span>
sha256sum /evidence/disk.dd
<span style="color: var(--text-muted);"># Compare with acquisition hash</span></pre>
          </div>
        </div>

        <h3>Triage Collection (KAPE)</h3>
        <div class="terminal">
          <div class="terminal-header">
            <span class="terminal-dot red"></span>
            <span class="terminal-dot yellow"></span>
            <span class="terminal-dot green"></span>
            <span style="margin-left: 1rem; color: var(--text-muted);">KAPE Collection</span>
          </div>
          <div class="terminal-body">
<pre><span style="color: var(--accent-cyan);"># Collect common forensic artifacts</span>
kape.exe --tsource C: --tdest E:\Evidence --target KapeTriage

<span style="color: var(--accent-cyan);"># Collect specific targets</span>
kape.exe --tsource C: --tdest E:\Evidence --target EventLogs,Registry,Prefetch

<span style="color: var(--accent-cyan);"># Collection targets include:</span>
- EventLogs (Windows event logs)
- Registry (all hives)
- Prefetch (execution history)
- $MFT (file system metadata)
- SRUM (System Resource Usage Monitor)
- Amcache (application execution)
- Browser artifacts</pre>
          </div>
        </div>

        <h3>Live Response Collection</h3>
        <div class="terminal">
          <div class="terminal-header">
            <span class="terminal-dot red"></span>
            <span class="terminal-dot yellow"></span>
            <span class="terminal-dot green"></span>
            <span style="margin-left: 1rem; color: var(--text-muted);">Windows Live Response</span>
          </div>
          <div class="terminal-body">
<pre><span style="color: var(--accent-cyan);"># Network connections</span>
netstat -anob > netstat.txt

<span style="color: var(--accent-cyan);"># Running processes</span>
tasklist /v > processes.txt
wmic process list full > wmic_processes.txt

<span style="color: var(--accent-cyan);"># Logged on users</span>
query user > users.txt
net session > sessions.txt

<span style="color: var(--accent-cyan);"># Scheduled tasks</span>
schtasks /query /fo csv /v > scheduled_tasks.csv

<span style="color: var(--accent-cyan);"># Services</span>
sc query > services.txt

<span style="color: var(--accent-cyan);"># Recent files</span>
dir %USERPROFILE%\Recent /a /s > recent_files.txt

<span style="color: var(--accent-cyan);"># DNS cache</span>
ipconfig /displaydns > dns_cache.txt</pre>
          </div>
        </div>
      </section>

      <section id="preservation">
        <h2>Evidence Preservation</h2>

        <h3>Hash Verification</h3>
        <p>
          Always hash evidence immediately upon collection and verify before analysis. 
          Use multiple algorithms for redundancy.
        </p>

        <div class="terminal">
          <div class="terminal-header">
            <span class="terminal-dot red"></span>
            <span class="terminal-dot yellow"></span>
            <span class="terminal-dot green"></span>
            <span style="margin-left: 1rem; color: var(--text-muted);">Hashing Evidence</span>
          </div>
          <div class="terminal-body">
<pre><span style="color: var(--accent-cyan);"># Windows PowerShell</span>
Get-FileHash -Algorithm SHA256 evidence.dd | Out-File evidence.sha256
Get-FileHash -Algorithm MD5 evidence.dd | Out-File evidence.md5

<span style="color: var(--accent-cyan);"># Linux</span>
sha256sum evidence.dd > evidence.sha256
md5sum evidence.dd > evidence.md5

<span style="color: var(--accent-cyan);"># Verify later</span>
sha256sum -c evidence.sha256
<span style="color: var(--accent-green);">evidence.dd: OK</span></pre>
          </div>
        </div>

        <h3>Storage Requirements</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Requirement</th>
                <th>Implementation</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Access Control</strong></td>
                <td>Locked room/cabinet, limited access list</td>
              </tr>
              <tr>
                <td><strong>Environmental</strong></td>
                <td>Climate controlled, protected from elements</td>
              </tr>
              <tr>
                <td><strong>Redundancy</strong></td>
                <td>Multiple copies on different media</td>
              </tr>
              <tr>
                <td><strong>Integrity Checking</strong></td>
                <td>Periodic hash verification</td>
              </tr>
              <tr>
                <td><strong>Access Logging</strong></td>
                <td>Log all access to evidence storage</td>
              </tr>
              <tr>
                <td><strong>Retention</strong></td>
                <td>Follow legal/regulatory requirements</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout callout-tip">
          <div class="callout-title">Working Copies</div>
          <p style="margin: 0;">
            Never analyze original evidence. Create a verified copy and analyze that. 
            Keep the original pristine for potential legal proceedings.
          </p>
        </div>
      </section>

      <section id="documentation">
        <h2>Documentation</h2>

        <h3>Evidence Documentation Checklist</h3>
        <ul class="checklist">
          <li><strong>What:</strong> Detailed description of evidence item</li>
          <li><strong>When:</strong> Collection date/time with timezone</li>
          <li><strong>Where:</strong> Source location (hostname, IP, path)</li>
          <li><strong>Who:</strong> Collector name and role</li>
          <li><strong>How:</strong> Collection method and tools used</li>
          <li><strong>Hashes:</strong> MD5, SHA1, SHA256 values</li>
          <li><strong>Storage:</strong> Where evidence is stored</li>
          <li><strong>Transfers:</strong> Log of custody transfers</li>
        </ul>

        <h3>Analysis Documentation</h3>
        <ul class="checklist">
          <li>Date/time of analysis</li>
          <li>Analyst name</li>
          <li>Tools and versions used</li>
          <li>Hash verification before analysis</li>
          <li>Steps performed (reproducible)</li>
          <li>Findings with supporting evidence</li>
          <li>Screenshots with timestamps</li>
          <li>Hash verification after analysis</li>
        </ul>

        <h3>Legal Considerations</h3>
        <div class="callout callout-warning">
          <div class="callout-title">Know Your Authority</div>
          <ul style="margin: 0;">
            <li>Ensure proper authorization before collection</li>
            <li>Understand privacy laws in your jurisdiction</li>
            <li>Employee investigations may require HR/Legal approval</li>
            <li>Cross-border data collection has legal implications</li>
            <li>Preserve attorney-client privilege where applicable</li>
          </ul>
        </div>
      </section>

      <div class="callout callout-success">
        <div class="callout-title">Key Takeaways</div>
        <ul style="margin: 0;">
          <li>Collect volatile evidence first (memory before disk)</li>
          <li>Document chain of custody from the moment of collection</li>
          <li>Hash evidence immediately and verify before analysis</li>
          <li>Never analyze original evidence‚Äîuse verified copies</li>
          <li>Minimize handlers; document every transfer</li>
          <li>Store evidence securely with access logging</li>
          <li>Involve Legal/HR early for employee or criminal cases</li>
          <li>Document everything: what, when, where, who, how</li>
        </ul>
      </div>

      <footer class="page-footer">
        <div class="footer-nav">
          <a href="ir-recovery.html" class="footer-link">
            <span class="footer-link-label">‚Üê Previous</span>
            <span class="footer-link-title">Recovery</span>
          </a>
          <a href="lessons-learned.html" class="footer-link" style="text-align: right;">
            <span class="footer-link-label">Next ‚Üí</span>
            <span class="footer-link-title">Lessons Learned</span>
          </a>
        </div>
      </footer>
    </main>
  </div>

  <script src="main.js"></script>
</body>
</html>
