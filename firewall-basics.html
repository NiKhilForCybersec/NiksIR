<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Firewall Fundamentals | SOC Analyst Guide</title>
  <meta name="description" content="Firewall concepts for SOC analysts: rule analysis, log interpretation, and investigating firewall alerts.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600&family=Orbitron:wght@400;500;600;700&family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="main.css">
</head>
<body>
  <button class="menu-toggle" aria-label="Toggle navigation">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M3 12h18M3 6h18M3 18h18"/>
    </svg>
  </button>

  <div class="page-wrapper">
    <aside class="sidebar">
      <div class="sidebar-header">
        <a href="../index.html" class="sidebar-logo" style="text-decoration: none;">
          <span>SOC Analyst Guide</span>
        </a>
      </div>
      <div class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">5. Network Security</div>
          <a href="network-fundamentals.html" class="nav-link"><span class="nav-link-icon">üåê</span> Network Fundamentals</a>
          <a href="firewall-basics.html" class="nav-link active"><span class="nav-link-icon">üî•</span> Firewalls</a>
          <a href="ids-ips.html" class="nav-link"><span class="nav-link-icon">üõ°Ô∏è</span> IDS/IPS</a>
          <a href="proxy-analysis.html" class="nav-link"><span class="nav-link-icon">üîÄ</span> Proxy & Web Filtering</a>
          <a href="dns-security.html" class="nav-link"><span class="nav-link-icon">üåç</span> DNS Security</a>
          <a href="traffic-analysis.html" class="nav-link"><span class="nav-link-icon">üìä</span> Traffic Analysis</a>
        </div>
        <div class="nav-section">
          <div class="nav-section-title">Related</div>
          <a href="common-ports.html" class="nav-link"><span class="nav-link-icon">üîå</span> Ports & Protocols</a>
        </div>
      </div>
    </aside>

    <main class="main-content">
      <div class="content-header">
        <nav class="breadcrumb">
          <a href="../index.html">Home</a>
          <span class="breadcrumb-separator">‚Ä∫</span>
          <a href="../index.html#network">Network Security</a>
          <span class="breadcrumb-separator">‚Ä∫</span>
          <span>Firewalls</span>
        </nav>
        <h1>Firewall Fundamentals</h1>
        <div class="page-meta">
          <span class="meta-item"><span class="tier-badge tier-all">All Tiers</span></span>
          <span class="meta-item">Section 5.2</span>
          <span class="meta-item">~12 min read</span>
        </div>
      </div>

      <div class="toc">
        <div class="toc-title">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 6h16M4 12h16M4 18h12"/>
          </svg>
          On This Page
        </div>
        <ul class="toc-list">
          <li><a href="#types">Firewall Types</a></li>
          <li><a href="#rules">Rule Components</a></li>
          <li><a href="#logs">Log Analysis</a></li>
          <li><a href="#ngfw">Next-Gen Features</a></li>
          <li><a href="#investigation">Investigation Tips</a></li>
        </ul>
      </div>

      <section id="types">
        <h2>Firewall Types</h2>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Type</th>
                <th>How It Works</th>
                <th>Capabilities</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Packet Filter</strong></td>
                <td>Inspects individual packets (Layer 3-4)</td>
                <td>Source/dest IP, ports, protocol. Fast but limited.</td>
              </tr>
              <tr>
                <td><strong>Stateful</strong></td>
                <td>Tracks connection state</td>
                <td>Understands sessions, allows return traffic automatically.</td>
              </tr>
              <tr>
                <td><strong>Application (WAF)</strong></td>
                <td>Inspects application layer (Layer 7)</td>
                <td>HTTP inspection, SQL injection prevention.</td>
              </tr>
              <tr>
                <td><strong>Next-Gen (NGFW)</strong></td>
                <td>Combines all above + more</td>
                <td>App awareness, IPS, TLS inspection, threat intel.</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout callout-info">
          <div class="callout-title">Modern Enterprise Reality</div>
          <p style="margin: 0;">
            Most enterprises use Next-Generation Firewalls (NGFW) that combine traditional firewall 
            capabilities with IPS, application awareness, and threat intelligence integration.
          </p>
        </div>
      </section>

      <section id="rules">
        <h2>Firewall Rule Components</h2>

        <div class="card">
          <h3>Anatomy of a Firewall Rule</h3>
          <div class="terminal">
            <div class="terminal-header">
              <span class="terminal-dot red"></span>
              <span class="terminal-dot yellow"></span>
              <span class="terminal-dot green"></span>
              <span style="margin-left: 1rem; color: var(--text-muted);">Example Rule</span>
            </div>
            <div class="terminal-body">
<pre>Rule 150: ALLOW
  Source Zone:      Internal
  Source IP:        10.0.0.0/8
  Destination Zone: External
  Destination IP:   Any
  Service:          HTTPS (tcp/443)
  Application:      web-browsing
  Action:           ALLOW
  Logging:          Enabled
  Profile:          URL-Filtering, Threat-Prevention</pre>
            </div>
          </div>
        </div>

        <h3>Rule Components Explained</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Component</th>
                <th>Description</th>
                <th>SOC Relevance</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Source/Dest Zone</strong></td>
                <td>Network segment (Internal, DMZ, External)</td>
                <td>Understand traffic direction and policy intent</td>
              </tr>
              <tr>
                <td><strong>Source/Dest IP</strong></td>
                <td>IP address or range</td>
                <td>Who is communicating with whom</td>
              </tr>
              <tr>
                <td><strong>Service/Port</strong></td>
                <td>Protocol and port (TCP/443, UDP/53)</td>
                <td>What type of traffic</td>
              </tr>
              <tr>
                <td><strong>Application</strong></td>
                <td>NGFW: Identified application (Slack, Dropbox)</td>
                <td>What the traffic actually is (beyond port)</td>
              </tr>
              <tr>
                <td><strong>Action</strong></td>
                <td>Allow, Deny, Drop</td>
                <td>Was traffic permitted or blocked?</td>
              </tr>
              <tr>
                <td><strong>Security Profile</strong></td>
                <td>Additional inspection (IPS, AV, URL)</td>
                <td>What additional checks were applied</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout callout-warning">
          <div class="callout-title">Deny vs. Drop</div>
          <p style="margin: 0;">
            <strong>Deny:</strong> Blocks and sends response (ICMP unreachable or TCP RST)<br>
            <strong>Drop:</strong> Silently discards packet (no response)<br>
            Drop is often preferred for external-facing rules to avoid revealing firewall presence.
          </p>
        </div>
      </section>

      <section id="logs">
        <h2>Firewall Log Analysis</h2>

        <h3>Key Log Fields</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Field</th>
                <th>Description</th>
                <th>Investigation Use</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Timestamp</strong></td>
                <td>When event occurred</td>
                <td>Timeline building, correlation</td>
              </tr>
              <tr>
                <td><strong>Source IP</strong></td>
                <td>Origin of traffic</td>
                <td>Identify attacker or compromised host</td>
              </tr>
              <tr>
                <td><strong>Destination IP</strong></td>
                <td>Target of traffic</td>
                <td>What was being accessed</td>
              </tr>
              <tr>
                <td><strong>Source/Dest Port</strong></td>
                <td>Port numbers</td>
                <td>Identify service, detect anomalies</td>
              </tr>
              <tr>
                <td><strong>Action</strong></td>
                <td>Allow/Deny/Drop</td>
                <td>Did traffic succeed?</td>
              </tr>
              <tr>
                <td><strong>Bytes Sent/Received</strong></td>
                <td>Data volume</td>
                <td>Detect exfiltration, large transfers</td>
              </tr>
              <tr>
                <td><strong>Rule Name/ID</strong></td>
                <td>Which rule matched</td>
                <td>Understand why action was taken</td>
              </tr>
              <tr>
                <td><strong>Application</strong></td>
                <td>NGFW identified app</td>
                <td>See actual traffic type</td>
              </tr>
              <tr>
                <td><strong>Threat Name</strong></td>
                <td>IPS signature matched</td>
                <td>Identify attack type</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>Sample Log Entry</h3>
        <div class="terminal">
          <div class="terminal-header">
            <span class="terminal-dot red"></span>
            <span class="terminal-dot yellow"></span>
            <span class="terminal-dot green"></span>
            <span style="margin-left: 1rem; color: var(--text-muted);">Palo Alto Traffic Log</span>
          </div>
          <div class="terminal-body">
<pre>2024-01-15T09:30:15Z TRAFFIC drop 
src=192.168.1.50 dst=203.0.113.100 
sport=52341 dport=4444
proto=tcp app=unknown-tcp
rule="Deny-Suspicious-Ports"
bytes_sent=120 bytes_rcvd=0</pre>
          </div>
        </div>
        <p class="text-muted">
          <strong>Interpretation:</strong> Outbound connection from internal host to external IP on port 4444 
          (common Metasploit default) was blocked. Possible C2 attempt or malware callback.
        </p>
      </section>

      <section id="ngfw">
        <h2>Next-Gen Firewall Features</h2>

        <div class="accordion">
          <div class="accordion-item active">
            <div class="accordion-header">
              <span class="accordion-title">Application Identification</span>
              <span class="accordion-icon">‚ñº</span>
            </div>
            <div class="accordion-content">
              <p>Identifies applications regardless of port. Example: Detecting Dropbox on port 443 vs. regular HTTPS.</p>
              <h4>SOC Value:</h4>
              <ul>
                <li>Detect tunneling (non-HTTP on 80/443)</li>
                <li>Identify shadow IT applications</li>
                <li>See true application even if encrypted</li>
              </ul>
            </div>
          </div>

          <div class="accordion-item">
            <div class="accordion-header">
              <span class="accordion-title">TLS/SSL Inspection</span>
              <span class="accordion-icon">‚ñº</span>
            </div>
            <div class="accordion-content">
              <p>Decrypts HTTPS traffic for inspection (man-in-the-middle).</p>
              <h4>SOC Value:</h4>
              <ul>
                <li>See inside encrypted traffic</li>
                <li>Detect malware in encrypted downloads</li>
                <li>Inspect C2 over HTTPS</li>
              </ul>
              <h4>Limitations:</h4>
              <ul>
                <li>May break certificate pinning</li>
                <li>Privacy/legal considerations</li>
                <li>Some sites may not work</li>
              </ul>
            </div>
          </div>

          <div class="accordion-item">
            <div class="accordion-header">
              <span class="accordion-title">Integrated IPS</span>
              <span class="accordion-icon">‚ñº</span>
            </div>
            <div class="accordion-content">
              <p>Built-in intrusion prevention with signature and behavior detection.</p>
              <h4>SOC Value:</h4>
              <ul>
                <li>Block known exploits inline</li>
                <li>Generate alerts for threats</li>
                <li>Combine with firewall context</li>
              </ul>
            </div>
          </div>

          <div class="accordion-item">
            <div class="accordion-header">
              <span class="accordion-title">Threat Intelligence</span>
              <span class="accordion-icon">‚ñº</span>
            </div>
            <div class="accordion-content">
              <p>Integration with threat feeds for known bad IPs, domains, and URLs.</p>
              <h4>SOC Value:</h4>
              <ul>
                <li>Automatic blocking of known malicious destinations</li>
                <li>C2 domain blocking</li>
                <li>Botnet protection</li>
              </ul>
            </div>
          </div>

          <div class="accordion-item">
            <div class="accordion-header">
              <span class="accordion-title">URL Filtering</span>
              <span class="accordion-icon">‚ñº</span>
            </div>
            <div class="accordion-content">
              <p>Categorize and control web access by URL category.</p>
              <h4>SOC Value:</h4>
              <ul>
                <li>Block known malware hosting sites</li>
                <li>Control access to file sharing, social media</li>
                <li>Log web activity for investigations</li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <section id="investigation">
        <h2>Investigation Tips</h2>

        <h3>Common Investigation Scenarios</h3>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Scenario</th>
                <th>What to Look For</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Blocked outbound to suspicious port</strong></td>
                <td>Check source host for malware, look for other connection attempts</td>
              </tr>
              <tr>
                <td><strong>High volume denied from single external IP</strong></td>
                <td>Scanning/reconnaissance, check IP reputation</td>
              </tr>
              <tr>
                <td><strong>Internal host hitting many destinations</strong></td>
                <td>Possible lateral movement, scanning, or worm</td>
              </tr>
              <tr>
                <td><strong>Traffic to rare destination country</strong></td>
                <td>Potential C2, check if business justified</td>
              </tr>
              <tr>
                <td><strong>Large outbound data transfer</strong></td>
                <td>Potential exfiltration, verify with user/business</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>Useful Queries</h3>
        <div class="query-box">
          <div class="query-header">
            <span class="query-lang">KQL</span>
            <span class="query-title">Top blocked outbound connections</span>
          </div>
          <div class="query-body">
<code>CommonSecurityLog
| <span class="kw">where</span> TimeGenerated > <span class="fn">ago</span>(<span class="nu">24h</span>)
| <span class="kw">where</span> DeviceAction == <span class="st">"Deny"</span>
| <span class="kw">where</span> CommunicationDirection == <span class="st">"Outbound"</span>
| <span class="kw">summarize</span> Count = <span class="fn">count</span>() <span class="kw">by</span> SourceIP, DestinationIP, 
    DestinationPort, ApplicationProtocol
| <span class="kw">order by</span> Count <span class="kw">desc</span>
| <span class="kw">take</span> <span class="nu">50</span></code>
          </div>
        </div>

        <div class="query-box">
          <div class="query-header">
            <span class="query-lang">KQL</span>
            <span class="query-title">Connections to non-standard ports</span>
          </div>
          <div class="query-body">
<code>CommonSecurityLog
| <span class="kw">where</span> TimeGenerated > <span class="fn">ago</span>(<span class="nu">24h</span>)
| <span class="kw">where</span> DeviceAction == <span class="st">"Allow"</span>
| <span class="kw">where</span> DestinationPort !<span class="kw">in</span> (<span class="nu">80</span>, <span class="nu">443</span>, <span class="nu">53</span>, <span class="nu">22</span>, <span class="nu">25</span>, <span class="nu">587</span>)
| <span class="kw">where</span> CommunicationDirection == <span class="st">"Outbound"</span>
| <span class="kw">summarize</span> Hosts = <span class="fn">dcount</span>(SourceIP), 
    Connections = <span class="fn">count</span>() <span class="kw">by</span> DestinationPort
| <span class="kw">where</span> Connections > <span class="nu">10</span>
| <span class="kw">order by</span> Connections <span class="kw">desc</span></code>
          </div>
        </div>
      </section>

      <div class="callout callout-success">
        <div class="callout-title">Key Takeaways</div>
        <ul style="margin: 0;">
          <li>NGFWs combine traditional firewall with IPS, app awareness, and threat intel</li>
          <li>Understand rule components: zones, IPs, ports, applications, actions</li>
          <li>Focus on blocked outbound traffic‚Äîindicates compromised internal hosts</li>
          <li>Application identification reveals true traffic even on standard ports</li>
          <li>Large data transfers and unusual destinations warrant investigation</li>
          <li>Know your environment's expected traffic patterns</li>
        </ul>
      </div>

      <footer class="page-footer">
        <div class="footer-nav">
          <a href="network-fundamentals.html" class="footer-link">
            <span class="footer-link-label">‚Üê Previous</span>
            <span class="footer-link-title">Network Fundamentals</span>
          </a>
          <a href="ids-ips.html" class="footer-link" style="text-align: right;">
            <span class="footer-link-label">Next ‚Üí</span>
            <span class="footer-link-title">IDS/IPS</span>
          </a>
        </div>
      </footer>
    </main>
  </div>

  <script src="main.js"></script>
</body>
</html>
